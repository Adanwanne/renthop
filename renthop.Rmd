---
title: "rent hop"
author: "Adaeze Ajoku"
date: "4/18/2017"
output: html_document
---

```{r reading files}
renthop.tr <- read.csv('/Users/adaezeajoku/Desktop/STATS415/Project/renthop_tr.csv')

renthop.te <- read.csv('/Users/adaezeajoku/Desktop/STATS415/Project/renthop_te.csv')
```

# Step 0: Preparing the Data
```{r data cleaning}
library(stringr)

#Removing the brackets
tofix = c(2:5, 9:10, 13:15)
entry_fix <- function(x){
  str_sub(x, 2, -2)
}
train <- data.frame(renthop.tr[,-tofix], apply(renthop.tr[,tofix], 2, entry_fix))
train <- train[,c(1, 7:10, 2:4, 11:12, 5:6, 13:15)]

#Creating a numeric variable for 'photos'
train$photos <- str_count(train$photos, ',') + 1

#Change 'created' to datetime format
train$created <- as.POSIXct(train$created)

#'description'
toRemove <- c('<a', '<br />', '<br/>', '<p>', 'website_redacted ')
train$description <- as.character(train$description)
train$description <- str_replace_all(train$description, "<br />", "")
train$description <- str_replace_all(train$description, "<br/>", " ")
train$description <- str_replace_all(train$description, "<p>", "")
train$description <- str_replace_all(train$description, "website_redacted ", "")

# create regex to catch and remove img html like: <br><img src= \" width=\"1\" height=\"1\" /><ul><li><a target=_blank href= Robert Dillon for more information</a> </li><li><a target=_blank href= full listing information on elliman.com</a> </li></ul></p>

```
#' Step 1: Do as much data exploration as possible by visualization, summary statistics and perhaps a more sophisticated dimensionality reduction method such as PCA and/or MDS. 
#' 

#' how much time is a posting live for interest_level to be gauged? 1 week? Are they still live?

#' How many observations of each interest level are there?
table(renthop.tr$interest_level)
#' 7.8% high, 69.5% low, 22.8% medium

#' What is the distribution of price by interest level?
boxplot(price~interest_level, data=renthop.tr) #eliminate outliers!
tapply(renthop.tr$price, renthop.tr$interest_level, summary)
#' mean prices: high = 2700.293, low=4176.599, medium=3158.767
#' So people are more interested the lower the price.

#' How many words are in the description for each interest_level?
#' What is the lat/long for listings by interest_level? Are there clusters of regions by interest_level?
#' Are there certain undesirable managers?
#' Are there more/less desirable buildings?
#' What are typical features offered? By interest_level?

#' Which streets are most common in listings?
streets <- table(renthop.tr$display_address)
#' Broadway, East 34th Street, Second Ave

#' Does no photo translate to low interest?
table(renthop.tr$interest_level[renthop.tr$photos == '[]'])
#' Yes 95% of the time.

#' Do no features translate to low interest?
table(renthop.tr$interest_level[renthop.tr$features == '[]'])
#' Yes 65% of the time.

#' Add photo_count column and binary photo column (0/1)
```

